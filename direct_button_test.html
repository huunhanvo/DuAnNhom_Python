<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Button Test Direct</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h3>Direct Button Test</h3>
        <div id="debug-info" style="background:yellow; padding:10px; margin:10px 0;"></div>
        
        <!-- Recreate exact button from template -->
        <button class="btn btn-sm btn-outline-primary flex-fill" 
                type="button"
                data-promo-id="1"
                data-promo-ma="TEST20"
                data-promo-ten="Test Voucher 20%"
                data-promo-mota="Voucher test cho debug"
                data-promo-loai="phan_tram"
                data-promo-giatri="20"
                data-promo-donhang="100000"
                data-promo-giamtoida="50000"
                data-promo-batdau="2025-01-01"
                data-promo-ketthuc="2025-12-31"
                data-promo-soluong="100"
                data-promo-trangthai="active"
                onclick="alert('Button clicked! ID: ' + this.dataset.promoId); editPromotionFromButton(this); console.log('Edit button clicked');">
            <i class="fas fa-edit"></i> Sá»­a
        </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function addDebugInfo(message) {
            const debugDiv = document.getElementById('debug-info');
            debugDiv.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }

        function editPromotionFromButton(button) {
            addDebugInfo('editPromotionFromButton CALLED');
            addDebugInfo('Button ID: ' + button.dataset.promoId);
            console.log('=== editPromotionFromButton CALLED ===');
            console.log('Button element:', button);
            console.log('Button dataset:', button.dataset);
            
            try {
                // Get data from button attributes
                const voucher = {
                    id: button.dataset.promoId,
                    ma_voucher: button.dataset.promoMa,
                    ten_voucher: button.dataset.promoTen,
                    mo_ta: button.dataset.promoMota,
                    loai_giam: button.dataset.promoLoai,
                    gia_tri_giam: button.dataset.promoGiatri,
                    gia_tri_don_hang_toi_thieu: button.dataset.promoDonhang,
                    gia_tri_giam_toi_da: button.dataset.promoGiamtoida,
                    ngay_bat_dau: button.dataset.promoBatdau + 'T09:00',
                    ngay_ket_thuc: button.dataset.promoKetthuc + 'T23:59',
                    so_luong_toi_da: button.dataset.promoSoluong,
                    trang_thai: button.dataset.promoTrangthai
                };
                
                addDebugInfo('Voucher data extracted: ' + JSON.stringify(voucher));
                alert('Data extracted successfully! Check console for details.');
                
            } catch (error) {
                addDebugInfo('Error: ' + error.message);
                alert('Error: ' + error.message);
            }
        }
        
        // Test on page load
        document.addEventListener('DOMContentLoaded', function() {
            addDebugInfo('Page loaded');
            const button = document.querySelector('.btn-outline-primary');
            if (button) {
                addDebugInfo('Button found with ID: ' + button.dataset.promoId);
            } else {
                addDebugInfo('No button found!');
            }
        });
    </script>
</body>
</html>